{% extends 'layout.html' %}
{% block body %}
<div id="chart_div"></div>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load("visualization", "1", {packages:["corechart"]});
google.setOnLoadCallback(drawChart);
function drawChart() {
	var data = new google.visualization.DataTable();
	data.addColumn('string', 'Date');
	data.addColumn('number', 'Steps');
	{% for day in cal %}
		{%- if day[1] %}
		data.addRow(['{{ day[0].strftime('%m/%d/%Y') }}',{{ day[1].count }}])
		{%- else %}
		data.addRow(['{{ day[0].strftime('%m/%d/%Y') }}', 0])
		{%- endif %}
	{% endfor %}
	var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
	chart.draw(data, {width: 600, height: 340, title: 'Steps for last 28 days'});
}
</script>
{% set first_month = cal[0][0].month %}
<table border="1" class="cal_table">
{%for i in range(4) %}
<tr>
{% for j in range(7) %}
	<td date="{{cal[j+(i*7)][0].strftime('%m/%d/%Y')}}" count="{{cal[j+(i*7)][1].count}}"
	{% if cal[j+(i*7)][0].month == first_month %}class="first_month">{% else %}<td class="last_month">{% endif %}
	<div>{{ cal[j+(i*7)][0].strftime('%m/%d') }}</div>
	<div>
	{%- if cal[j+(i*7)][1] %}
		{{cal[j+(i*7)][1].count}}
	{% else %}
		N/A
	{% endif %}
	</div>
	</td>
{% endfor %}
</tr>
{% endfor %}
</table>
<div id="new_activity"">
<script type="text/javascript" src="js/DatePicker.js"></script>
<form action="/activity" method="POST">
<fieldset>
	<label>Steps</label><input name="count" /><br />
	<label>When</label><input name="created" class="date-pick" /><br />
	<input type="hidden" name="key" value="" />
	<button>Record</button><button id="cancel">Cancel</button>
</fieldset>
</form>
<script>
	$(function() {
		$( ".date-pick" ).datepicker();
	});
	$("#cancel").click(function() {$("#new_activity").hide(); return false;});
</script>
</div>
<a href="/activity">Add Activity</a> |
<a href="/user">User Info</a>
<script>
	function activityPopUp(count,date,key)
	{
	}
	$("td").click(function() {
			$("input[name='created']").val($(this).attr('date'));
			$("input[name='count']").val($(this).attr('count'));
			var offset = $(this).offset();
			$("#new_activity").show();
			$("#new_activity").offset({top: offset.top, left: offset.left});
		});
</script>
{% endblock %}